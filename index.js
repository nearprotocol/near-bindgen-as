!function(e,i){"object"==typeof exports&&"object"==typeof module?module.exports=i():"function"==typeof define&&define.amd?define([],i):"object"==typeof exports?exports.transformer=i():e.transformer=i()}("undefined"!=typeof self?self:this,(function(){return function(e){var i={};function t(s){if(i[s])return i[s].exports;var n=i[s]={i:s,l:!1,exports:{}};return e[s].call(n.exports,n,n.exports,t),n.l=!0,n.exports}return t.m=e,t.c=i,t.d=function(e,i,s){t.o(e,i)||Object.defineProperty(e,i,{enumerable:!0,get:s})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,i){if(1&i&&(e=t(e)),8&i)return e;if(4&i&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(t.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&i&&"string"!=typeof e)for(var n in e)t.d(s,n,function(i){return e[i]}.bind(null,n));return s},t.n=function(e){var i=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(i,"a",i),i},t.o=function(e,i){return Object.prototype.hasOwnProperty.call(e,i)},t.p="",t(t.s=2)}([function(e,i,t){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),function(e){e[e.NULL=0]="NULL",e[e.LINEFEED=10]="LINEFEED",e[e.CARRIAGERETURN=13]="CARRIAGERETURN",e[e.LINESEPARATOR=8232]="LINESEPARATOR",e[e.PARAGRAPHSEPARATOR=8233]="PARAGRAPHSEPARATOR",e[e.NEXTLINE=133]="NEXTLINE",e[e.SPACE=32]="SPACE",e[e.NONBREAKINGSPACE=160]="NONBREAKINGSPACE",e[e.ENQUAD=8192]="ENQUAD",e[e.EMQUAD=8193]="EMQUAD",e[e.ENSPACE=8194]="ENSPACE",e[e.EMSPACE=8195]="EMSPACE",e[e.THREEPEREMSPACE=8196]="THREEPEREMSPACE",e[e.FOURPEREMSPACE=8197]="FOURPEREMSPACE",e[e.SIXPEREMSPACE=8198]="SIXPEREMSPACE",e[e.FIGURESPACE=8199]="FIGURESPACE",e[e.PUNCTUATIONSPACE=8200]="PUNCTUATIONSPACE",e[e.THINSPACE=8201]="THINSPACE",e[e.HAIRSPACE=8202]="HAIRSPACE",e[e.ZEROWIDTHSPACE=8203]="ZEROWIDTHSPACE",e[e.NARROWNOBREAKSPACE=8239]="NARROWNOBREAKSPACE",e[e.IDEOGRAPHICSPACE=12288]="IDEOGRAPHICSPACE",e[e.MATHEMATICALSPACE=8287]="MATHEMATICALSPACE",e[e.OGHAM=5760]="OGHAM",e[e._=95]="_",e[e._0=48]="_0",e[e._1=49]="_1",e[e._2=50]="_2",e[e._3=51]="_3",e[e._4=52]="_4",e[e._5=53]="_5",e[e._6=54]="_6",e[e._7=55]="_7",e[e._8=56]="_8",e[e._9=57]="_9",e[e.a=97]="a",e[e.b=98]="b",e[e.c=99]="c",e[e.d=100]="d",e[e.e=101]="e",e[e.f=102]="f",e[e.g=103]="g",e[e.h=104]="h",e[e.i=105]="i",e[e.j=106]="j",e[e.k=107]="k",e[e.l=108]="l",e[e.m=109]="m",e[e.n=110]="n",e[e.o=111]="o",e[e.p=112]="p",e[e.q=113]="q",e[e.r=114]="r",e[e.s=115]="s",e[e.t=116]="t",e[e.u=117]="u",e[e.v=118]="v",e[e.w=119]="w",e[e.x=120]="x",e[e.y=121]="y",e[e.z=122]="z",e[e.A=65]="A",e[e.B=66]="B",e[e.C=67]="C",e[e.D=68]="D",e[e.E=69]="E",e[e.F=70]="F",e[e.G=71]="G",e[e.H=72]="H",e[e.I=73]="I",e[e.J=74]="J",e[e.K=75]="K",e[e.L=76]="L",e[e.M=77]="M",e[e.N=78]="N",e[e.O=79]="O",e[e.P=80]="P",e[e.Q=81]="Q",e[e.R=82]="R",e[e.S=83]="S",e[e.T=84]="T",e[e.U=85]="U",e[e.V=86]="V",e[e.W=87]="W",e[e.X=88]="X",e[e.Y=89]="Y",e[e.Z=90]="Z",e[e.AMPERSAND=38]="AMPERSAND",e[e.ASTERISK=42]="ASTERISK",e[e.AT=64]="AT",e[e.BACKSLASH=92]="BACKSLASH",e[e.BACKTICK=96]="BACKTICK",e[e.BAR=124]="BAR",e[e.CARET=94]="CARET",e[e.CLOSEBRACE=125]="CLOSEBRACE",e[e.CLOSEBRACKET=93]="CLOSEBRACKET",e[e.CLOSEPAREN=41]="CLOSEPAREN",e[e.COLON=58]="COLON",e[e.COMMA=44]="COMMA",e[e.DOLLAR=36]="DOLLAR",e[e.DOT=46]="DOT",e[e.DOUBLEQUOTE=34]="DOUBLEQUOTE",e[e.EQUALS=61]="EQUALS",e[e.EXCLAMATION=33]="EXCLAMATION",e[e.GREATERTHAN=62]="GREATERTHAN",e[e.HASH=35]="HASH",e[e.LESSTHAN=60]="LESSTHAN",e[e.MINUS=45]="MINUS",e[e.OPENBRACE=123]="OPENBRACE",e[e.OPENBRACKET=91]="OPENBRACKET",e[e.OPENPAREN=40]="OPENPAREN",e[e.PERCENT=37]="PERCENT",e[e.PLUS=43]="PLUS",e[e.QUESTION=63]="QUESTION",e[e.SEMICOLON=59]="SEMICOLON",e[e.SINGLEQUOTE=39]="SINGLEQUOTE",e[e.SLASH=47]="SLASH",e[e.TILDE=126]="TILDE",e[e.BACKSPACE=8]="BACKSPACE",e[e.FORMFEED=12]="FORMFEED",e[e.BYTEORDERMARK=65279]="BYTEORDERMARK",e[e.TAB=9]="TAB",e[e.VERTICALTAB=11]="VERTICALTAB"}(i.CharCode||(i.CharCode={})),function(e){e[e.ABSTRACT=0]="ABSTRACT",e[e.AS=1]="AS",e[e.ASYNC=2]="ASYNC",e[e.AWAIT=3]="AWAIT",e[e.BREAK=4]="BREAK",e[e.CASE=5]="CASE",e[e.CATCH=6]="CATCH",e[e.CLASS=7]="CLASS",e[e.CONST=8]="CONST",e[e.CONTINUE=9]="CONTINUE",e[e.CONSTRUCTOR=10]="CONSTRUCTOR",e[e.DEBUGGER=11]="DEBUGGER",e[e.DECLARE=12]="DECLARE",e[e.DEFAULT=13]="DEFAULT",e[e.DELETE=14]="DELETE",e[e.DO=15]="DO",e[e.ELSE=16]="ELSE",e[e.ENUM=17]="ENUM",e[e.EXPORT=18]="EXPORT",e[e.EXTENDS=19]="EXTENDS",e[e.FALSE=20]="FALSE",e[e.FINALLY=21]="FINALLY",e[e.FOR=22]="FOR",e[e.FROM=23]="FROM",e[e.FUNCTION=24]="FUNCTION",e[e.GET=25]="GET",e[e.IF=26]="IF",e[e.IMPLEMENTS=27]="IMPLEMENTS",e[e.IMPORT=28]="IMPORT",e[e.IN=29]="IN",e[e.INSTANCEOF=30]="INSTANCEOF",e[e.INTERFACE=31]="INTERFACE",e[e.IS=32]="IS",e[e.KEYOF=33]="KEYOF",e[e.LET=34]="LET",e[e.MODULE=35]="MODULE",e[e.NAMESPACE=36]="NAMESPACE",e[e.NEW=37]="NEW",e[e.NULL=38]="NULL",e[e.OF=39]="OF",e[e.PACKAGE=40]="PACKAGE",e[e.PRIVATE=41]="PRIVATE",e[e.PROTECTED=42]="PROTECTED",e[e.PUBLIC=43]="PUBLIC",e[e.READONLY=44]="READONLY",e[e.RETURN=45]="RETURN",e[e.SET=46]="SET",e[e.STATIC=47]="STATIC",e[e.SUPER=48]="SUPER",e[e.SWITCH=49]="SWITCH",e[e.THIS=50]="THIS",e[e.THROW=51]="THROW",e[e.TRUE=52]="TRUE",e[e.TRY=53]="TRY",e[e.TYPE=54]="TYPE",e[e.TYPEOF=55]="TYPEOF",e[e.VAR=56]="VAR",e[e.VOID=57]="VOID",e[e.WHILE=58]="WHILE",e[e.WITH=59]="WITH",e[e.YIELD=60]="YIELD",e[e.OPENBRACE=61]="OPENBRACE",e[e.CLOSEBRACE=62]="CLOSEBRACE",e[e.OPENPAREN=63]="OPENPAREN",e[e.CLOSEPAREN=64]="CLOSEPAREN",e[e.OPENBRACKET=65]="OPENBRACKET",e[e.CLOSEBRACKET=66]="CLOSEBRACKET",e[e.DOT=67]="DOT",e[e.DOT_DOT_DOT=68]="DOT_DOT_DOT",e[e.SEMICOLON=69]="SEMICOLON",e[e.COMMA=70]="COMMA",e[e.LESSTHAN=71]="LESSTHAN",e[e.GREATERTHAN=72]="GREATERTHAN",e[e.LESSTHAN_EQUALS=73]="LESSTHAN_EQUALS",e[e.GREATERTHAN_EQUALS=74]="GREATERTHAN_EQUALS",e[e.EQUALS_EQUALS=75]="EQUALS_EQUALS",e[e.EXCLAMATION_EQUALS=76]="EXCLAMATION_EQUALS",e[e.EQUALS_EQUALS_EQUALS=77]="EQUALS_EQUALS_EQUALS",e[e.EXCLAMATION_EQUALS_EQUALS=78]="EXCLAMATION_EQUALS_EQUALS",e[e.EQUALS_GREATERTHAN=79]="EQUALS_GREATERTHAN",e[e.PLUS=80]="PLUS",e[e.MINUS=81]="MINUS",e[e.ASTERISK_ASTERISK=82]="ASTERISK_ASTERISK",e[e.ASTERISK=83]="ASTERISK",e[e.SLASH=84]="SLASH",e[e.PERCENT=85]="PERCENT",e[e.PLUS_PLUS=86]="PLUS_PLUS",e[e.MINUS_MINUS=87]="MINUS_MINUS",e[e.LESSTHAN_LESSTHAN=88]="LESSTHAN_LESSTHAN",e[e.GREATERTHAN_GREATERTHAN=89]="GREATERTHAN_GREATERTHAN",e[e.GREATERTHAN_GREATERTHAN_GREATERTHAN=90]="GREATERTHAN_GREATERTHAN_GREATERTHAN",e[e.AMPERSAND=91]="AMPERSAND",e[e.BAR=92]="BAR",e[e.CARET=93]="CARET",e[e.EXCLAMATION=94]="EXCLAMATION",e[e.TILDE=95]="TILDE",e[e.AMPERSAND_AMPERSAND=96]="AMPERSAND_AMPERSAND",e[e.BAR_BAR=97]="BAR_BAR",e[e.QUESTION=98]="QUESTION",e[e.COLON=99]="COLON",e[e.EQUALS=100]="EQUALS",e[e.PLUS_EQUALS=101]="PLUS_EQUALS",e[e.MINUS_EQUALS=102]="MINUS_EQUALS",e[e.ASTERISK_EQUALS=103]="ASTERISK_EQUALS",e[e.ASTERISK_ASTERISK_EQUALS=104]="ASTERISK_ASTERISK_EQUALS",e[e.SLASH_EQUALS=105]="SLASH_EQUALS",e[e.PERCENT_EQUALS=106]="PERCENT_EQUALS",e[e.LESSTHAN_LESSTHAN_EQUALS=107]="LESSTHAN_LESSTHAN_EQUALS",e[e.GREATERTHAN_GREATERTHAN_EQUALS=108]="GREATERTHAN_GREATERTHAN_EQUALS",e[e.GREATERTHAN_GREATERTHAN_GREATERTHAN_EQUALS=109]="GREATERTHAN_GREATERTHAN_GREATERTHAN_EQUALS",e[e.AMPERSAND_EQUALS=110]="AMPERSAND_EQUALS",e[e.BAR_EQUALS=111]="BAR_EQUALS",e[e.CARET_EQUALS=112]="CARET_EQUALS",e[e.AT=113]="AT",e[e.IDENTIFIER=114]="IDENTIFIER",e[e.STRINGLITERAL=115]="STRINGLITERAL",e[e.INTEGERLITERAL=116]="INTEGERLITERAL",e[e.FLOATLITERAL=117]="FLOATLITERAL",e[e.INVALID=118]="INVALID",e[e.ENDOFFILE=119]="ENDOFFILE"}(i.Token||(i.Token={})),function(e){e[e.NONE=0]="NONE",e[e.IMPORT=1]="IMPORT",e[e.EXPORT=2]="EXPORT",e[e.DECLARE=4]="DECLARE",e[e.CONST=8]="CONST",e[e.LET=16]="LET",e[e.STATIC=32]="STATIC",e[e.READONLY=64]="READONLY",e[e.ABSTRACT=128]="ABSTRACT",e[e.PUBLIC=256]="PUBLIC",e[e.PRIVATE=512]="PRIVATE",e[e.PROTECTED=1024]="PROTECTED",e[e.GET=2048]="GET",e[e.SET=4096]="SET",e[e.DEFINITE_ASSIGNMENT=8192]="DEFINITE_ASSIGNMENT",e[e.AMBIENT=16384]="AMBIENT",e[e.GENERIC=32768]="GENERIC",e[e.GENERIC_CONTEXT=65536]="GENERIC_CONTEXT",e[e.INSTANCE=131072]="INSTANCE",e[e.CONSTRUCTOR=262144]="CONSTRUCTOR",e[e.MODULE_EXPORT=524288]="MODULE_EXPORT",e[e.MODULE_IMPORT=1048576]="MODULE_IMPORT",e[e.RESOLVED=2097152]="RESOLVED",e[e.COMPILED=4194304]="COMPILED",e[e.INLINED=8388608]="INLINED",e[e.SCOPED=16777216]="SCOPED",e[e.TRAMPOLINE=33554432]="TRAMPOLINE",e[e.VIRTUAL=67108864]="VIRTUAL",e[e.MAIN=134217728]="MAIN",e[e.QUOTED=268435456]="QUOTED"}(i.CommonFlags||(i.CommonFlags={})),function(e){e[e.SOURCE=0]="SOURCE",e[e.NAMEDTYPE=1]="NAMEDTYPE",e[e.FUNCTIONTYPE=2]="FUNCTIONTYPE",e[e.TYPENAME=3]="TYPENAME",e[e.TYPEPARAMETER=4]="TYPEPARAMETER",e[e.PARAMETER=5]="PARAMETER",e[e.IDENTIFIER=6]="IDENTIFIER",e[e.ASSERTION=7]="ASSERTION",e[e.BINARY=8]="BINARY",e[e.CALL=9]="CALL",e[e.CLASS=10]="CLASS",e[e.COMMA=11]="COMMA",e[e.ELEMENTACCESS=12]="ELEMENTACCESS",e[e.FALSE=13]="FALSE",e[e.FUNCTION=14]="FUNCTION",e[e.INSTANCEOF=15]="INSTANCEOF",e[e.LITERAL=16]="LITERAL",e[e.NEW=17]="NEW",e[e.NULL=18]="NULL",e[e.PARENTHESIZED=19]="PARENTHESIZED",e[e.PROPERTYACCESS=20]="PROPERTYACCESS",e[e.TERNARY=21]="TERNARY",e[e.SUPER=22]="SUPER",e[e.THIS=23]="THIS",e[e.TRUE=24]="TRUE",e[e.CONSTRUCTOR=25]="CONSTRUCTOR",e[e.UNARYPOSTFIX=26]="UNARYPOSTFIX",e[e.UNARYPREFIX=27]="UNARYPREFIX",e[e.BLOCK=28]="BLOCK",e[e.BREAK=29]="BREAK",e[e.CONTINUE=30]="CONTINUE",e[e.DO=31]="DO",e[e.EMPTY=32]="EMPTY",e[e.EXPORT=33]="EXPORT",e[e.EXPORTDEFAULT=34]="EXPORTDEFAULT",e[e.EXPORTIMPORT=35]="EXPORTIMPORT",e[e.EXPRESSION=36]="EXPRESSION",e[e.FOR=37]="FOR",e[e.IF=38]="IF",e[e.IMPORT=39]="IMPORT",e[e.RETURN=40]="RETURN",e[e.SWITCH=41]="SWITCH",e[e.THROW=42]="THROW",e[e.TRY=43]="TRY",e[e.VARIABLE=44]="VARIABLE",e[e.VOID=45]="VOID",e[e.WHILE=46]="WHILE",e[e.CLASSDECLARATION=47]="CLASSDECLARATION",e[e.ENUMDECLARATION=48]="ENUMDECLARATION",e[e.ENUMVALUEDECLARATION=49]="ENUMVALUEDECLARATION",e[e.FIELDDECLARATION=50]="FIELDDECLARATION",e[e.FUNCTIONDECLARATION=51]="FUNCTIONDECLARATION",e[e.IMPORTDECLARATION=52]="IMPORTDECLARATION",e[e.INDEXSIGNATUREDECLARATION=53]="INDEXSIGNATUREDECLARATION",e[e.INTERFACEDECLARATION=54]="INTERFACEDECLARATION",e[e.METHODDECLARATION=55]="METHODDECLARATION",e[e.NAMESPACEDECLARATION=56]="NAMESPACEDECLARATION",e[e.TYPEDECLARATION=57]="TYPEDECLARATION",e[e.VARIABLEDECLARATION=58]="VARIABLEDECLARATION",e[e.DECORATOR=59]="DECORATOR",e[e.EXPORTMEMBER=60]="EXPORTMEMBER",e[e.SWITCHCASE=61]="SWITCHCASE",e[e.COMMENT=62]="COMMENT"}(i.NodeKind||(i.NodeKind={})),function(e){e[e.USER=0]="USER",e[e.USER_ENTRY=1]="USER_ENTRY",e[e.LIBRARY=2]="LIBRARY",e[e.LIBRARY_ENTRY=3]="LIBRARY_ENTRY"}(i.SourceKind||(i.SourceKind={})),function(e){e[e.DEFAULT=0]="DEFAULT",e[e.OPTIONAL=1]="OPTIONAL",e[e.REST=2]="REST"}(i.ParameterKind||(i.ParameterKind={})),function(e){e[e.FLOAT=0]="FLOAT",e[e.INTEGER=1]="INTEGER",e[e.STRING=2]="STRING",e[e.REGEXP=3]="REGEXP",e[e.ARRAY=4]="ARRAY",e[e.OBJECT=5]="OBJECT"}(i.LiteralKind||(i.LiteralKind={}))},function(e,i,t){"use strict";Object.defineProperty(i,"__esModule",{value:!0});const s=t(7),n=t(0);class r extends s.AbstractVisitor{constructor(){super(...arguments),this.depth=0}_visit(e){switch(e.kind){case n.NodeKind.SOURCE:this.visitSource(e);break;case n.NodeKind.NAMEDTYPE:this.visitNamedTypeNode(e);break;case n.NodeKind.FUNCTIONTYPE:this.visitFunctionTypeNode(e);break;case n.NodeKind.TYPENAME:this.visitTypeName(e);case n.NodeKind.TYPEPARAMETER:this.visitTypeParameter(e);break;case n.NodeKind.FALSE:case n.NodeKind.NULL:case n.NodeKind.SUPER:case n.NodeKind.THIS:case n.NodeKind.TRUE:case n.NodeKind.CONSTRUCTOR:case n.NodeKind.IDENTIFIER:this.visitIdentifierExpression(e);break;case n.NodeKind.ASSERTION:this.visitAssertionExpression(e);break;case n.NodeKind.BINARY:this.visitBinaryExpression(e);break;case n.NodeKind.CALL:this.visitCallExpression(e);break;case n.NodeKind.CLASS:this.visitClassExpression(e);break;case n.NodeKind.COMMA:this.visitCommaExpression(e);break;case n.NodeKind.ELEMENTACCESS:this.visitElementAccessExpression(e);break;case n.NodeKind.FUNCTION:this.visitFunctionExpression(e);break;case n.NodeKind.INSTANCEOF:this.visitInstanceOfExpression(e);break;case n.NodeKind.LITERAL:this.visitLiteralExpression(e);break;case n.NodeKind.NEW:this.visitNewExpression(e);break;case n.NodeKind.PARENTHESIZED:this.visitParenthesizedExpression(e);break;case n.NodeKind.PROPERTYACCESS:this.visitPropertyAccessExpression(e);break;case n.NodeKind.TERNARY:this.visitTernaryExpression(e);break;case n.NodeKind.UNARYPOSTFIX:this.visitUnaryPostfixExpression(e);break;case n.NodeKind.UNARYPREFIX:this.visitUnaryPrefixExpression(e);break;case n.NodeKind.BLOCK:this.visitBlockStatement(e);break;case n.NodeKind.BREAK:this.visitBreakStatement(e);break;case n.NodeKind.CONTINUE:this.visitContinueStatement(e);break;case n.NodeKind.DO:this.visitDoStatement(e);break;case n.NodeKind.EMPTY:this.visitEmptyStatement(e);break;case n.NodeKind.EXPORT:this.visitExportStatement(e);break;case n.NodeKind.EXPORTDEFAULT:this.visitExportDefaultStatement(e);break;case n.NodeKind.EXPORTIMPORT:this.visitExportImportStatement(e);break;case n.NodeKind.EXPRESSION:this.visitExpressionStatement(e);break;case n.NodeKind.FOR:this.visitForStatement(e);break;case n.NodeKind.IF:this.visitIfStatement(e);break;case n.NodeKind.IMPORT:this.visitImportStatement(e);break;case n.NodeKind.RETURN:this.visitReturnStatement(e);break;case n.NodeKind.SWITCH:this.visitSwitchStatement(e);break;case n.NodeKind.THROW:this.visitThrowStatement(e);break;case n.NodeKind.TRY:this.visitTryStatement(e);break;case n.NodeKind.VARIABLE:this.visitVariableStatement(e);break;case n.NodeKind.WHILE:this.visitWhileStatement(e);break;case n.NodeKind.CLASSDECLARATION:this.visitClassDeclaration(e);break;case n.NodeKind.ENUMDECLARATION:this.visitEnumDeclaration(e);break;case n.NodeKind.ENUMVALUEDECLARATION:this.visitEnumValueDeclaration(e);break;case n.NodeKind.FIELDDECLARATION:this.visitFieldDeclaration(e);break;case n.NodeKind.FUNCTIONDECLARATION:this.visitFunctionDeclaration(e);break;case n.NodeKind.IMPORTDECLARATION:this.visitImportDeclaration(e);break;case n.NodeKind.INDEXSIGNATUREDECLARATION:this.visitIndexSignatureDeclaration(e);break;case n.NodeKind.INTERFACEDECLARATION:this.visitInterfaceDeclaration(e);break;case n.NodeKind.METHODDECLARATION:this.visitMethodDeclaration(e);break;case n.NodeKind.NAMESPACEDECLARATION:this.visitNamespaceDeclaration(e);break;case n.NodeKind.TYPEDECLARATION:this.visitTypeDeclaration(e);break;case n.NodeKind.VARIABLEDECLARATION:this.visitVariableDeclaration(e);break;case n.NodeKind.DECORATOR:this.visitDecoratorNode(e);break;case n.NodeKind.EXPORTMEMBER:this.visitExportMember(e);break;case n.NodeKind.PARAMETER:this.visitParameter(e);break;case n.NodeKind.SWITCHCASE:this.visitSwitchCase(e);break;default:assert(!1)}}visitSource(e){for(const i of e.statements)this.depth++,this.visit(i),this.depth--}visitTypeNode(e){}visitTypeName(e){this.visit(e.identifier),e.next&&this.visit(e.next)}visitNamedTypeNode(e){this.visit(e.name),this.visit(e.typeArguments)}visitFunctionTypeNode(e){for(let i of e.parameters)this.visit(i);this.visit(e.returnType)}visitTypeParameter(e){this.visit(e.name),e.extendsType&&this.visit(e.extendsType),e.defaultType&&this.visit(e.defaultType)}visitIdentifierExpression(e){}visitArrayLiteralExpression(e){e.elementExpressions.map(e=>{e&&this.visit(e)})}visitObjectLiteralExpression(e){if(e.values&&e.names){assert(e.values.length==e.names.length);for(let i=0;i<e.values.length;i++)this.visit(e.names[i]),this.visit(e.values[i])}}visitAssertionExpression(e){e.toType&&this.visit(e.toType),this.visit(e.expression)}visitBinaryExpression(e){this.visit(e.left),this.visit(e.right)}visitCallExpression(e){this.visit(e.expression),this.visit(e.typeArguments),this.visit(e.arguments)}visitClassExpression(e){this.visit(e.declaration)}visitCommaExpression(e){this.visit(e.expressions)}visitElementAccessExpression(e){this.visit(e.elementExpression),this.visit(e.expression)}visitFunctionExpression(e){this.visit(e.declaration)}visitLiteralExpression(e){}visitFloatLiteralExpression(e){}visitInstanceOfExpression(e){this.visit(e.expression),this.visit(e.isType)}visitIntegerLiteralExpression(e){}visitStringLiteral(e,i){}visitStringLiteralExpression(e){}visitRegexpLiteralExpression(e){}visitNewExpression(e){this.visit(e.expression),this.visit(e.typeArguments),this.visit(e.arguments)}visitParenthesizedExpression(e){this.visit(e.expression)}visitPropertyAccessExpression(e){this.visit(e.property),this.visit(e.expression)}visitTernaryExpression(e){this.visit(e.condition),this.visit(e.ifThen),this.visit(e.ifElse)}visitUnaryExpression(e){this.visit(e.operand)}visitUnaryPostfixExpression(e){this.visit(e.operand)}visitUnaryPrefixExpression(e){this.visit(e.operand)}visitSuperExpression(e){}visitFalseExpression(e){}visitTrueExpression(e){}visitThisExpression(e){}visitNullExperssion(e){}visitConstructorExpression(e){}visitNodeAndTerminate(e){}visitBlockStatement(e){this.depth++,this.visit(e.statements),this.depth--}visitBreakStatement(e){e.label&&this.visit(e.label)}visitContinueStatement(e){e.label&&this.visit(e.label)}visitClassDeclaration(e,i){this.visit(e.name),this.depth++,this.visit(e.decorators),assert(e.isGeneric?null!=e.typeParameters:null==e.typeParameters),e.isGeneric&&this.visit(e.typeParameters),e.extendsType&&this.visit(e.extendsType),this.visit(e.implementsTypes),this.visit(e.members),this.depth--}visitDoStatement(e){this.visit(e.condition),this.visit(e.statement)}visitEmptyStatement(e){}visitEnumDeclaration(e,i){this.visit(e.name),this.visit(e.decorators),this.visit(e.values)}visitEnumValueDeclaration(e){this.visit(e.name),e.initializer&&this.visit(e.initializer)}visitExportImportStatement(e){this.visit(e.name),this.visit(e.externalName)}visitExportMember(e){this.visit(e.localName),this.visit(e.exportedName)}visitExportStatement(e){e.path&&this.visit(e.path),this.visit(e.members)}visitExportDefaultStatement(e){this.visit(e.declaration)}visitExpressionStatement(e){this.visit(e.expression)}visitFieldDeclaration(e){this.visit(e.name),e.type&&this.visit(e.type),e.initializer&&this.visit(e.initializer),this.visit(e.decorators)}visitForStatement(e){e.initializer&&this.visit(e.initializer),e.condition&&this.visit(e.condition),e.incrementor&&this.visit(e.incrementor),this.visit(e.statement)}visitFunctionDeclaration(e,i){this.visit(e.name),this.visit(e.decorators),e.isGeneric&&this.visit(e.typeParameters),this.visit(e.signature),this.depth++,e.body&&this.visit(e.body),this.depth--}visitFunctionCommon(e){}visitIfStatement(e){this.visit(e.condition),this.visit(e.ifTrue),e.ifFalse&&this.visit(e.ifFalse)}visitImportDeclaration(e){this.visit(e.foreignName),this.visit(e.name),this.visit(e.decorators)}visitImportStatement(e){e.namespaceName&&this.visit(e.namespaceName),this.visit(e.declarations)}visitIndexSignatureDeclaration(e){}visitInterfaceDeclaration(e,i){this.visit(e.name),e.isGeneric&&this.visit(e.typeParameters),this.visit(e.implementsTypes),e.extendsType&&this.visit(e.extendsType),this.depth++,this.visit(e.members),this.depth--}visitMethodDeclaration(e){this.visit(e.name),e.isGeneric&&this.visit(e.typeParameters),this.visit(e.signature),this.visit(e.decorators),this.depth++,e.body&&this.visit(e.body),this.depth--}visitNamespaceDeclaration(e,i){this.visit(e.name),this.visit(e.decorators),this.visit(e.members)}visitReturnStatement(e){e.value&&this.visit(e.value)}visitSwitchCase(e){e.label&&this.visit(e.label),this.visit(e.statements)}visitSwitchStatement(e){this.visit(e.condition),this.depth++,this.visit(e.cases),this.depth--}visitThrowStatement(e){this.visit(e.value)}visitTryStatement(e){this.visit(e.statements),e.catchVariable&&this.visit(e.catchVariable),this.visit(e.catchStatements),this.visit(e.finallyStatements)}visitTypeDeclaration(e){this.visit(e.name),this.visit(e.decorators),this.visit(e.type),this.visit(e.typeParameters)}visitVariableDeclaration(e){this.visit(e.name),e.type&&this.visit(e.type),e.initializer&&this.visit(e.initializer)}visitVariableStatement(e){this.visit(e.decorators),this.visit(e.declarations)}visitWhileStatement(e){this.visit(e.condition),this.depth++,this.visit(e.statement),this.depth--}visitVoidStatement(e){}visitComment(e){}visitDecoratorNode(e){this.visit(e.name),this.visit(e.arguments)}visitParameter(e){this.visit(e.name),e.implicitFieldDeclaration&&this.visit(e.implicitFieldDeclaration),e.initializer&&this.visit(e.initializer),this.visit(e.type)}}i.BaseVisitor=r},function(e,i,t){"use strict";t(0);const s=t(3);e.exports=s.JSONTransformer},function(e,i,t){"use strict";Object.defineProperty(i,"__esModule",{value:!0});const s=t(4),n=t(8);class r extends class{}{afterParse(e){this.parser=e;const i=this.writeFile,t=this.baseDir;let a=s.JSONBindingsBuilder.nearFiles(e);r.isTest=a.map(e=>e.normalizedPath).some(e=>e.includes("spec")),a.forEach(n=>{let r=n.text.substr(0,n.text.indexOf("\n")).includes("out");e.donelog.delete(n.internalPath),e.seenlog.delete(n.internalPath),e.program.sources=e.program.sources.filter(e=>e!==n);let a=s.JSONBindingsBuilder.build(e,n);r&&i("out/"+n.normalizedPath,a,t),e.parseFile(a,(s.isEntry(n)?"":"./")+n.normalizedPath,s.isEntry(n))});{const e='\nimport { base64 } from "near-runtime-ts";\nimport { JSONEncoder as _JSONEncoder, JSONDecoder, ThrowingJSONHandler } from "assemblyscript-json";\nimport { u128 } from "bignum";\n// Runtime functions\n// tslint:disable: no-unsafe-any\n\n@global\nclass JSONEncoder extends _JSONEncoder {}\n\ntype Usize = u64;\n//@ts-ignore\n@global\n@external("env", "read_register")\ndeclare function read_register(register_id: Usize, ptr: Usize): void;\n//@ts-ignore\n@global\n@external("env", "register_len")\ndeclare function register_len(register_id: Usize): Usize;\n\n//@ts-ignore\n@global\n@external("env", "input")\ndeclare function input(register_id: Usize): void;\n//@ts-ignore\n@global\n@external("env", "value_return")\ndeclare function value_return(value_len: Usize, value_ptr: Usize): void;\n//@ts-ignore\n@global\n@external("env", "panic")\ndeclare function panic(): void;\n//@ts-ignore\n@global\nfunction getInput(): Obj { \n  // Reading input bytes.\n  input(0);\n  let json_len = register_len(0);\n  if (json_len == U32.MAX_VALUE) {\n    panic();\n  }\n  let json = new Uint8Array(json_len as u32);\n  //@ts-ignore\n  read_register(0, <usize>json.buffer);\n  return <Obj> JSON.parse(json);\n}\n\nabstract class Value {\n  static String(str: string): Value {\n    return new Str(str);\n  }\n  static Number(num: i64): Value {\n    return new Num(num);\n  }\n  static Bool(b: bool): Value {\n    return new Bools(b);\n  }\n  static Null(): Value {\n    return new Null();\n  }\n  static Array(): Value {\n    return new Arr();\n  }\n  static Object(): Value {\n    return new Obj();\n  }\n\n  toString(): string {\n    if (this instanceof Str) {\n      return (<Str>this).toString();\n    }\n    if (this instanceof Num) {\n      return (<Num>this).toString();\n    }\n    if (this instanceof Bools) {\n      return (<Bools>this).toString();\n    }\n    if (this instanceof Null) {\n      return (<Null>this).toString();\n    }\n    if (this instanceof Arr) {\n      return (<Arr>this).toString();\n    }\n    if (this instanceof Obj) {\n      return (<Obj>this).toString();\n    }\n    return "Value";\n  }\n}\n//@ts-ignore\n@global\nclass Str extends Value {\n  constructor(public _str: string) {\n    super();\n  }\n\n  toString(): string {\n    return "\\"" + this._str + "\\"";\n  }\n}\n//@ts-ignore\n@global\nclass Num extends Value {\n  constructor(public _num: i64) {\n    super();\n  }\n\n  toString(): string {\n    return this._num.toString();\n  }\n}\n//@ts-ignore\n@global\nclass Null extends Value {\n  constructor() {\n    super();\n  }\n\n  toString(): string {\n    return "null";\n  }\n}\n\n//@ts-ignore\n@global class Bools extends Value {\n  constructor(public _bool: bool) {\n    super();\n  }\n\n  toString(): string {\n    return this._bool.toString();\n  }\n}\n\n//@ts-ignore\n@global\nclass Arr extends Value {\n  _arr: Array<Value>;\n  constructor() {\n    super();\n    this._arr = new Array<Value>();\n  }\n\n  push(obj: Value): void {\n    this._arr.push(obj);\n  }\n\n  toString(): string {\n    return "[" + this._arr.map<string>((val: Value,i: i32,_arr: Value[]): string  => val.toString()).join(",") + "]";\n  }\n}\n\n//@ts-ignore\n@global\nclass Obj extends Value {\n  _obj: Map<string, Value>;\n  keys: Array<string>;\n\n  constructor() {\n    super();\n    this._obj = new Map();\n    this.keys = new Array();\n  }\n\n  set(key: string, value: Value): void {\n    if (!this._obj.has(key)) {\n      this.keys.push(key);\n    }\n    this._obj.set(key, value);\n  }\n\n  get(key: string): Value | null {\n    if (!this._obj.has(key)) {\n      return null;\n    }\n    return this._obj.get(key);\n  }\n\n  toString(): string {\n    const objs: string[] = [];\n    for (let i: i32 = 0; i < this.keys.length; i++) {\n      objs.push("\\"" + this.keys[i] + "\\":" + this._obj.get(this.keys[i]).toString());\n    }\n    return "{" + objs.join(",") + "}";\n  }\n\n  has(key: string): bool {\n    return this._obj.has(key);\n  }\n}\n\nclass Handler extends ThrowingJSONHandler {\n  stack: Value[];\n  constructor() {\n    super();\n    this.stack = new Array<Value>();\n  }\n\n  reset(): void {\n    while (this.stack.length > 0) {\n      this.stack.pop();\n    }\n  }\n\n  get peek(): Value {\n    return this.stack[this.stack.length - 1];\n  }\n\n  setString(name: string, value: string): void {\n    const obj: Value = Value.String(value);\n    this.addValue(name, obj);\n  }\n\n  setBoolean(name: string, value: bool): void {\n    const obj = Value.Bool(value);\n    this.addValue(name, obj);\n  }\n\n  setNull(name: string): void {\n    const obj = Value.Null();\n    this.addValue(name, obj);\n  }\n\n  setInteger(name: string, value: i64): void {\n    const obj = Value.Number(value);\n    this.addValue(name, obj);\n  }\n\n  pushArray(name: string): bool {\n    const obj: Value = Value.Array();\n    if (this.stack.length == 0) {\n      this.stack.push(obj);\n    } else {\n      this.addValue(name, obj)\n      this.stack.push(obj);\n    }\n    return true;\n  }\n\n  popArray(): void {\n    if (this.stack.length > 1) {\n      this.stack.pop();\n    }\n  }\n\n  pushObject(name: string): bool {\n    const obj: Value = Value.Object();\n    this.addValue(name, obj);\n    this.stack.push(obj);\n    return true;\n  }\n\n  popObject(): void {\n    if (this.stack.length > 1) {\n      this.stack.pop();\n    }\n  }\n\n  addValue(name: string, obj: Value): void {\n    if (name.length == 0 && this.stack.length == 0) {\n      this.stack.push(obj);\n      return;\n    }\n    if (this.peek instanceof Obj) {\n      (this.peek as Obj).set(name, obj);\n    }\n    else if (this.peek instanceof Arr) {\n      (<Arr>this.peek).push(obj);\n    }\n  }\n}\n\n//@ts-ignore\n@global()\nclass JSON {\n  private static handler: Handler = new Handler();\n  private static decoder: JSONDecoder<Handler> = new JSONDecoder<Handler>(JSON.handler);\n  static parse(str: Uint8Array ): Value {\n    JSON.decoder.deserialize(str);\n    const res = JSON.decoder.handler.peek;\n    JSON.decoder.handler.reset();\n    return res;\n  }\n}\n\n//@ts-ignore\n@global\nfunction encode<T, Output = Uint8Array>(value: T, name: string | null = "", encoder: JSONEncoder = new JSONEncoder()): Output {\n  if (isBoolean<T>()) {\n    //@ts-ignore\n    encoder.setBoolean(name, value);\n  } else if (isInteger<T>()) {\n    if (value instanceof i64 || value instanceof u64) {\n      //@ts-ignore\n      encoder.setString(name, value.toString());\n    } else {\n    //@ts-ignore\n      encoder.setInteger(name, value);\n    }\n    //@ts-ignore\n  } else if (value == <T>null) {\n    encoder.setNull(name);\n  } else if (isString<T>()) {\n    //@ts-ignore\n    encoder.setString(name, value);\n  } else if (isReference<T>()) {\n    if (isArrayLike<T>(value)) {\n      if (value instanceof Uint8Array) {\n        //@ts-ignore\n        encoder.setString(name, base64.encode(<Uint8Array> value));\n      } else {\n        encoder.pushArray(name);\n        for (let i: i32 = 0; i < value.length; i++) {\n          //@ts-ignore\n          encode<valueof<T>, JSONEncoder>(value[i], null, encoder);\n        }\n        encoder.popArray();\n      }\n    } else { // Is an object\n      if (value instanceof u128) {\n        encoder.setString(name, value.toString());\n      } else {\n        //@ts-ignore\n        value._encode(name, encoder);\n      }\n    }\n  } else {\n    throw new Error("Encoding failed");\n  }\n  var output: Output;\n  //@ts-ignore\n  if (output instanceof Uint8Array) {\n    //@ts-ignore\n    return <Output>encoder.serialize();\n  }\n  //@ts-ignore\n  assert( output instanceof JSONEncoder, "Bad return type for encoder");\n  //@ts-ignore\n  return <Output>encoder;\n}\n\n//@ts-ignore\n@inline\nfunction getStr(val: Value, name: String): string {\n  assert(val instanceof Str, "Value with Key: " + name + " is not a string or null");\n  return (<Str>val)._str;\n}\n\nfunction decodeArray<T>(val: Value, name: string): Array<T> {\n  assert(val instanceof Arr, "Value with Key: " + name + " is not an array or null.");\n  const res = new Array<T>();\n  const arr = (<Arr>val)._arr;\n  for (let i: i32 = 0; i < arr.length; i++) {\n    let item: T = decode<T, Value>(arr[i]);\n    res.push(item);\n  }\n  return res;\n}\n\nfunction isReallyNullable<T>(): bool {\n  return isReference<T>() || isArrayLike<T>() || isNullable<T>() || isString<T>();\n}\n\n//@ts-ignore\n@global\nfunction decode<T, V = Uint8Array>(buf: V, name: string = ""): T {\n  const buffer = <Value>(buf instanceof Uint8Array ? JSON.parse(buf) : buf);\n  var val: Value;\n  if (buffer instanceof Obj && name != "") {\n    const obj: Obj = <Obj>buffer;\n    let res = obj.get(name);\n    if (res == null) {\n      //@ts-ignore\n      return <T>null;\n    }\n    val = res;\n  }else {\n    val = <Value> buffer;\n  }\n  if (val instanceof Null) {\n    assert(isReallyNullable<T>(), "Key: " + name + " with type " + nameof<T>() + "is not nullable.");\n    //@ts-ignore\n    return <T>null;\n  }\n  if (isString<T>()) {\n    //@ts-ignore\n    return getStr(val, name);\n  }\n  if (isBoolean<T>()) {\n    assert(val instanceof Bools, "Value with Key: " +  name + " with type " + nameof<T>()  + " is not a string");\n    //@ts-ignore\n    return (<Bools>val)._bool;\n  }\n  var value: T;\n  if (isInteger<T>()) {\n    //@ts-ignore\n    if (value instanceof u64 || value instanceof i64) {\n      assert(val instanceof Str, "Value with Key: " +  name + " with type " + nameof<T>()  + " is an 64-bit integer and is expected to be encoded as a string");\n      let str = (<Str>val)._str;\n      //@ts-ignore\n      return <T>(val instanceof u64) ? U64.parseInt(str) : I64.parseInt(str);\n    }\n    assert(val instanceof Num, "Value with Key: " +  name + " with type " + nameof<T>()  + " is not an Integer");\n    //@ts-ignore\n    return <T>(<Num>val)._num;\n  }\n  assert(isReference<T>(), name + " with type " + nameof<T>() + " must be an integer, boolean, string, object, or array");\n  if (isArrayLike<T>()) {\n    //@ts-ignore\n    if (value instanceof Uint8Array ) {\n      //@ts-ignore\n      return base64.decode(getStr(val, name));\n    }\n    //@ts-ignore\n    // assert(val instanceof Arr, "Value with Key: " +  name + " with type " + nameof<T>()  + " is expected to be an array")\n    //@ts-ignore only checking the instance\n    return <T>decodeArray<valueof<T>>(val, name);\n  }\n  //@ts-ignore\n  if (value instanceof u128) {\n    assert(val instanceof Str);\n    //@ts-ignore\n    return u128.fromString(getStr(val, name));\n  }\n  assert(val instanceof Obj, "Value with Key: " +  name + " with type " + nameof<T>()  + " is not an object or null");\n  value = instantiate<T>();\n  //@ts-ignore\n  return value.decode<Obj>(<Obj>val);\n}\n';this.parser.parseFile(e,"nearFile",!0)}r.isTest||n.TypeChecker.check(e)}afterCompile(e){r.isTest||n.TypeChecker.checkBinary(e)}}i.JSONTransformer=r,r.isTest=!1},function(e,i,t){"use strict";Object.defineProperty(i,"__esModule",{value:!0});const s=t(5),n=t(1),r=t(0);function a(e){return e.text.includes("@nearfile")||E(e)}function o(e){return s.ASTBuilder.build(e)}function E(e){return(e.kind==r.NodeKind.SOURCE?e:e.range.source).sourceKind==r.SourceKind.USER_ENTRY}function h(e){return e.kind==r.NodeKind.CLASSDECLARATION}function l(e){return e.kind==r.NodeKind.FIELDDECLARATION}i.isEntry=E;class d extends n.BaseVisitor{constructor(){super(...arguments),this.sb=[],this.exportedClasses=new Map,this.wrappedFuncs=new Set}static build(e,i){return(new d).build(i)}static nearFiles(e){return e.program.sources.filter(a)}visitClassDeclaration(e){this.exportedClasses.has(o(e.name))||this.exportedClasses.set(o(e.name),e),super.visitClassDeclaration(e)}visitFunctionDeclaration(e){!E(e)||this.wrappedFuncs.has(o(e.name))||!e.is(r.CommonFlags.EXPORT)||0==function(e){return e.signature.parameters.length}(e)&&function(e){return"void"===o(e.signature.returnType)}(e)?super.visitFunctionDeclaration(e):(this.generateWrapperFunction(e),e.flags=e.flags^r.CommonFlags.EXPORT,this.wrappedFuncs.add(o(e.name)),super.visit(e))}generateWrapperFunction(e){let i=e.signature,t=i.parameters,s=i.returnType,n=o(s).split("|").map(e=>e.trim()).filter(e=>"null"!==e).join("|"),r=o(s).includes("null"),a=e.name.symbol;this.sb.push(`function __wrapper_${a}(): void {`),t.length>0&&this.sb.push("  const obj = getInput();"),"void"!==o(s)?this.sb.push(`  let result: ${o(s)} = ${a}(`):this.sb.push(`  ${a}(`),t.length>0&&(this.sb[this.sb.length-1]+=t.map(e=>u(e)).join(", ")),this.sb[this.sb.length-1]+=");","void"!==o(s)&&this.sb.push(`  const val = encode<${n}>(${r?`changetype<${n}>(result)`:"result"});\n  value_return(val.byteLength, <usize>val.buffer);`),this.sb.push(`}\nexport { __wrapper_${a} as ${a} }`)}typeName(e){if(!h(e))return s.ASTBuilder.build(e);let i=o((e=e).name);return e.isGeneric&&(i+="<"+e.typeParameters.map(o).join(", ")+">"),i}build(e){return this.sb=[],this.visit(e),e.statements.map(e=>{let i=s.ASTBuilder.build(e);if(h(e)){let t=e;if(i=i.slice(0,i.lastIndexOf("}")),t.members.filter(l).map(e=>e).some(e=>null==e.type))throw new Error("All Fields must have explict type declaration.");let s=this.typeName(t);i+=`\n  decode<V = Uint8Array>(buf: V): ${s} {\n    let json: Obj;\n    if (buf instanceof Uint8Array) {\n      json = JSON.parse(buf);\n    } else {\n      assert(buf instanceof Obj, "argument must be Uint8Array or Json Object");\n      json = <Obj> buf;\n    }\n    return this._decode(json);\n  }\n\n  private _decode(obj: Obj): ${s} {\n    ${function(e){return e.members.filter(l).map(e=>{const i=o(e.name);return u(e,`this.${i} = obj.has("${i}") ? `)+`: this.${i};`})}(t).join("\n    ")}\n    return this;\n  }\n\n  _encode(name: string | null = "", _encoder: JSONEncoder | null = null): JSONEncoder {\n    let encoder = (_encoder == null ? new JSONEncoder() : _encoder)!;\n    encoder.pushObject(name);\n    ${function(e){return e.members.filter(l).map(e=>{let i=o(e.type),t=o(e.name);return`encode<${i}, JSONEncoder>(this.${t}, "${t}", encoder);`})}(t).join("\n    ")}\n    encoder.popObject();\n    return encoder;\n  }\n  encode(): Uint8Array {\n    return this._encode().serialize();\n  }\n\n  serialize(): Uint8Array {\n    return this.encode();\n  }\n\n  toJSON(): string {\n    return this._encode().toString();\n  }\n}`}return i}).concat(this.sb).join("\n")}}function u(e,i=""){return`${i}decode<${o(e.type)}, Obj>(obj, "${o(e.name)}")`}i.JSONBindingsBuilder=d},function(e,i,t){"use strict";Object.defineProperty(i,"__esModule",{value:!0});const s=t(6),n=t(0);class r{constructor(){this.sb=[],this.indentLevel=0}static build(e){var i=new r;return i.visitNode(e),i.finish()}visitNode(e){switch(e.kind){case n.NodeKind.SOURCE:this.visitSource(e);break;case n.NodeKind.NAMEDTYPE:this.visitNamedTypeNode(e);break;case n.NodeKind.FUNCTIONTYPE:this.visitFunctionTypeNode(e);break;case n.NodeKind.TYPEPARAMETER:this.visitTypeParameter(e);break;case n.NodeKind.FALSE:case n.NodeKind.NULL:case n.NodeKind.SUPER:case n.NodeKind.THIS:case n.NodeKind.TRUE:case n.NodeKind.CONSTRUCTOR:case n.NodeKind.IDENTIFIER:this.visitIdentifierExpression(e);break;case n.NodeKind.ASSERTION:this.visitAssertionExpression(e);break;case n.NodeKind.BINARY:this.visitBinaryExpression(e);break;case n.NodeKind.CALL:this.visitCallExpression(e);break;case n.NodeKind.CLASS:this.visitClassExpression(e);break;case n.NodeKind.COMMA:this.visitCommaExpression(e);break;case n.NodeKind.ELEMENTACCESS:this.visitElementAccessExpression(e);break;case n.NodeKind.FUNCTION:this.visitFunctionExpression(e);break;case n.NodeKind.INSTANCEOF:this.visitInstanceOfExpression(e);break;case n.NodeKind.LITERAL:this.visitLiteralExpression(e);break;case n.NodeKind.NEW:this.visitNewExpression(e);break;case n.NodeKind.PARENTHESIZED:this.visitParenthesizedExpression(e);break;case n.NodeKind.PROPERTYACCESS:this.visitPropertyAccessExpression(e);break;case n.NodeKind.TERNARY:this.visitTernaryExpression(e);break;case n.NodeKind.UNARYPOSTFIX:this.visitUnaryPostfixExpression(e);break;case n.NodeKind.UNARYPREFIX:this.visitUnaryPrefixExpression(e);break;case n.NodeKind.BLOCK:this.visitBlockStatement(e);break;case n.NodeKind.BREAK:this.visitBreakStatement(e);break;case n.NodeKind.CONTINUE:this.visitContinueStatement(e);break;case n.NodeKind.DO:this.visitDoStatement(e);break;case n.NodeKind.EMPTY:this.visitEmptyStatement(e);break;case n.NodeKind.EXPORT:this.visitExportStatement(e);break;case n.NodeKind.EXPORTDEFAULT:this.visitExportDefaultStatement(e);break;case n.NodeKind.EXPORTIMPORT:this.visitExportImportStatement(e);break;case n.NodeKind.EXPRESSION:this.visitExpressionStatement(e);break;case n.NodeKind.FOR:this.visitForStatement(e);break;case n.NodeKind.IF:this.visitIfStatement(e);break;case n.NodeKind.IMPORT:this.visitImportStatement(e);break;case n.NodeKind.RETURN:this.visitReturnStatement(e);break;case n.NodeKind.SWITCH:this.visitSwitchStatement(e);break;case n.NodeKind.THROW:this.visitThrowStatement(e);break;case n.NodeKind.TRY:this.visitTryStatement(e);break;case n.NodeKind.VARIABLE:this.visitVariableStatement(e);break;case n.NodeKind.WHILE:this.visitWhileStatement(e);break;case n.NodeKind.CLASSDECLARATION:this.visitClassDeclaration(e);break;case n.NodeKind.ENUMDECLARATION:this.visitEnumDeclaration(e);break;case n.NodeKind.ENUMVALUEDECLARATION:this.visitEnumValueDeclaration(e);break;case n.NodeKind.FIELDDECLARATION:this.visitFieldDeclaration(e);break;case n.NodeKind.FUNCTIONDECLARATION:this.visitFunctionDeclaration(e);break;case n.NodeKind.IMPORTDECLARATION:this.visitImportDeclaration(e);break;case n.NodeKind.INDEXSIGNATUREDECLARATION:this.visitIndexSignatureDeclaration(e);break;case n.NodeKind.INTERFACEDECLARATION:this.visitInterfaceDeclaration(e);break;case n.NodeKind.METHODDECLARATION:this.visitMethodDeclaration(e);break;case n.NodeKind.NAMESPACEDECLARATION:this.visitNamespaceDeclaration(e);break;case n.NodeKind.TYPEDECLARATION:this.visitTypeDeclaration(e);break;case n.NodeKind.VARIABLEDECLARATION:this.visitVariableDeclaration(e);break;case n.NodeKind.DECORATOR:this.serializeDecorator(e);break;case n.NodeKind.EXPORTMEMBER:this.visitExportMember(e);break;case n.NodeKind.PARAMETER:this.serializeParameter(e);break;case n.NodeKind.SWITCHCASE:this.visitSwitchCase(e);break;default:assert(!1)}}visitSource(e){var i=e.statements;for(let e=0,t=i.length;e<t;++e)this.visitNodeAndTerminate(i[e])}visitTypeNode(e){switch(e.kind){case n.NodeKind.NAMEDTYPE:this.visitNamedTypeNode(e);break;case n.NodeKind.FUNCTIONTYPE:this.visitFunctionTypeNode(e);break;default:assert(!1)}}visitTypeName(e){this.visitIdentifierExpression(e.identifier);for(var i=this.sb,t=e.next;t;)i.push("."),this.visitIdentifierExpression(t.identifier),t=t.next}visitNamedTypeNode(e){this.visitTypeName(e.name);var i=e.typeArguments;if(i){let t=i.length,s=this.sb;if(t){s.push("<"),this.visitTypeNode(i[0]);for(let e=1;e<t;++e)s.push(", "),this.visitTypeNode(i[e]);s.push(">")}e.isNullable&&s.push(" | null")}}visitFunctionTypeNode(e){var i=e.isNullable,t=this.sb;t.push(i?"((":"(");var s=e.explicitThisType;s&&(t.push("this: "),this.visitTypeNode(s));var n=e.parameters,r=n.length;if(r){s&&t.push(", "),this.serializeParameter(n[0]);for(let e=1;e<r;++e)t.push(", "),this.serializeParameter(n[e])}var a=e.returnType;a?(t.push(") => "),this.visitTypeNode(a)):t.push(") => void"),i&&t.push(") | null")}visitTypeParameter(e){this.visitIdentifierExpression(e.name);var i=e.extendsType;i&&(this.sb.push(" extends "),this.visitTypeNode(i));var t=e.defaultType;t&&(this.sb.push("="),this.visitTypeNode(t))}visitIdentifierExpression(e){e.isQuoted?this.visitStringLiteral(e.text):this.sb.push(e.text)}visitArrayLiteralExpression(e){var i=this.sb;i.push("[");var t=e.elementExpressions,s=t.length;if(s){t[0]&&this.visitNode(t[0]);for(let e=1;e<s;++e)i.push(", "),t[e]&&this.visitNode(t[e])}i.push("]")}visitObjectLiteralExpression(e){var i=this.sb,t=e.names,n=e.values,r=t.length;if(assert(r==n.length),r){i.push("{\n"),s.indent(i,++this.indentLevel),this.visitNode(t[0]),i.push(": "),this.visitNode(n[0]);for(let e=1;e<r;++e){i.push(",\n"),s.indent(i,this.indentLevel);let r=t[e],a=n[e];r===a?this.visitNode(r):(this.visitNode(r),i.push(": "),this.visitNode(a))}i.push("\n"),s.indent(i,--this.indentLevel),i.push("}")}else i.push("{}")}visitAssertionExpression(e){var i=this.sb;switch(e.assertionKind){case AssertionKind.PREFIX:i.push("<"),this.visitTypeNode(assert(e.toType)),i.push(">"),this.visitNode(e.expression);break;case AssertionKind.AS:this.visitNode(e.expression),i.push(" as "),this.visitTypeNode(assert(e.toType));break;case AssertionKind.NONNULL:this.visitNode(e.expression),i.push("!");break;default:assert(!1)}}visitBinaryExpression(e){var i=this.sb;this.visitNode(e.left),i.push(" "),i.push(s.operatorTokenToString(e.operator)),i.push(" "),this.visitNode(e.right)}visitCallExpression(e){var i=this.sb;this.visitNode(e.expression);var t=e.typeArguments;if(t){let e=t.length;if(e){i.push("<"),this.visitTypeNode(t[0]);for(let s=1;s<e;++s)i.push(", "),this.visitTypeNode(t[s]);i.push(">(")}}else i.push("(");var s=e.arguments,n=s.length;if(n){this.visitNode(s[0]);for(let e=1;e<n;++e)i.push(", "),this.visitNode(s[e])}i.push(")")}visitClassExpression(e){var i=e.declaration;this.visitClassDeclaration(i)}visitCommaExpression(e){var i=e.expressions,t=assert(i.length);this.visitNode(i[0]);var s=this.sb;for(let e=1;e<t;++e)s.push(","),this.visitNode(i[e])}visitElementAccessExpression(e){var i=this.sb;this.visitNode(e.expression),i.push("["),this.visitNode(e.elementExpression),i.push("]")}visitFunctionExpression(e){var i=e.declaration;i.arrowKind?assert(0==i.name.text.length):i.name.text.length?this.sb.push("function "):this.sb.push("function"),this.visitFunctionCommon(i)}visitLiteralExpression(e){switch(e.literalKind){case n.LiteralKind.FLOAT:this.visitFloatLiteralExpression(e);break;case n.LiteralKind.INTEGER:this.visitIntegerLiteralExpression(e);break;case n.LiteralKind.STRING:this.visitStringLiteralExpression(e);break;case n.LiteralKind.REGEXP:this.visitRegexpLiteralExpression(e);break;case n.LiteralKind.ARRAY:this.visitArrayLiteralExpression(e);break;case n.LiteralKind.OBJECT:this.visitObjectLiteralExpression(e);break;default:assert(!1)}}visitFloatLiteralExpression(e){this.sb.push(e.value.toString(10))}visitInstanceOfExpression(e){this.visitNode(e.expression),this.sb.push(" instanceof "),this.visitTypeNode(e.isType)}visitIntegerLiteralExpression(e){this.sb.push(s.i64_to_string(e.value))}visitStringLiteral(e,i=!1){var t=this.sb,s=0,n=i?"'":'"';t.push(n);var r=0;for(let n=e.length;r<n;)switch(e.charCodeAt(r)){case 0:r>s&&t.push(e.substring(s,s=r+1)),t.push("\\0"),s=++r;break;case 8:r>s&&t.push(e.substring(s,r)),s=++r,t.push("\\b");break;case 9:r>s&&t.push(e.substring(s,r)),s=++r,t.push("\\t");break;case 10:r>s&&t.push(e.substring(s,r)),s=++r,t.push("\\n");break;case 11:r>s&&t.push(e.substring(s,r)),s=++r,t.push("\\v");break;case 12:r>s&&t.push(e.substring(s,r)),s=++r,t.push("\\f");break;case 13:r>s&&t.push(e.substring(s,r)),t.push("\\r"),s=++r;break;case 34:i?++r:(r>s&&t.push(e.substring(s,r)),t.push('\\"'),s=++r);break;case 39:i?(r>s&&t.push(e.substring(s,r)),t.push("\\'"),s=++r):++r;break;case 92:r>s&&t.push(e.substring(s,r)),t.push("\\\\"),s=++r;break;default:++r}r>s&&t.push(e.substring(s,r)),t.push(n)}visitStringLiteralExpression(e){this.visitStringLiteral(e.value)}visitRegexpLiteralExpression(e){var i=this.sb;i.push("/"),i.push(e.pattern),i.push("/"),i.push(e.patternFlags)}visitNewExpression(e){this.sb.push("new "),this.visitCallExpression(e)}visitParenthesizedExpression(e){var i=this.sb;i.push("("),this.visitNode(e.expression),i.push(")")}visitPropertyAccessExpression(e){this.visitNode(e.expression),this.sb.push("."),this.visitIdentifierExpression(e.property)}visitTernaryExpression(e){var i=this.sb;this.visitNode(e.condition),i.push(" ? "),this.visitNode(e.ifThen),i.push(" : "),this.visitNode(e.ifElse)}visitUnaryExpression(e){switch(e.kind){case n.NodeKind.UNARYPOSTFIX:this.visitUnaryPostfixExpression(e);break;case n.NodeKind.UNARYPREFIX:this.visitUnaryPrefixExpression(e);break;default:assert(!1)}}visitUnaryPostfixExpression(e){this.visitNode(e.operand),this.sb.push(s.operatorTokenToString(e.operator))}visitUnaryPrefixExpression(e){this.sb.push(s.operatorTokenToString(e.operator)),this.visitNode(e.operand)}visitNodeAndTerminate(e){this.visitNode(e);var i=this.sb;if(i.length&&e.kind!=n.NodeKind.VARIABLE&&e.kind!=n.NodeKind.EXPRESSION){let e=i[i.length-1],t=e.length-1;t>=0&&(125==e.charCodeAt(t)||59==e.charCodeAt(t))?i.push("\n"):i.push(";\n")}else i.push(";\n")}visitBlockStatement(e){var i=this.sb,t=e.statements,n=t.length;if(n){i.push("{\n");let e=++this.indentLevel;for(let r=0;r<n;++r)s.indent(i,e),this.visitNodeAndTerminate(t[r]);s.indent(i,--this.indentLevel),i.push("}")}else i.push("{}")}visitBreakStatement(e){var i=e.label;i?(this.sb.push("break "),this.visitIdentifierExpression(i)):this.sb.push("break")}visitContinueStatement(e){var i=e.label;i?(this.sb.push("continue "),this.visitIdentifierExpression(i)):this.sb.push("continue")}visitClassDeclaration(e,i=!1){var t=e.decorators;if(t)for(let e=0,i=t.length;e<i;++e)this.serializeDecorator(t[e]);var r=this.sb;i?r.push("export default "):this.serializeExternalModifiers(e),e.is(n.CommonFlags.ABSTRACT)&&r.push("abstract "),e.name.text.length?(r.push("class "),this.visitIdentifierExpression(e.name)):r.push("class");var a=e.typeParameters;if(a&&a.length){r.push("<"),this.visitTypeParameter(a[0]);for(let e=1,i=a.length;e<i;++e)r.push(", "),this.visitTypeParameter(a[e]);r.push(">")}var o=e.extendsType;o&&(r.push(" extends "),this.visitTypeNode(o));var E=e.implementsTypes;if(E){let e=E.length;if(e){r.push(" implements "),this.visitTypeNode(E[0]);for(let i=1;i<e;++i)r.push(", "),this.visitTypeNode(E[i])}}var h=e.members;if(h.length){r.push(" {\n");let e=++this.indentLevel;for(let i=0,t=h.length;i<t;++i){let t=h[i];(t.kind!=n.NodeKind.FIELDDECLARATION||t.parameterIndex<0)&&(s.indent(r,e),this.visitNodeAndTerminate(t))}s.indent(r,--this.indentLevel),r.push("}")}else r.push(" {}")}visitDoStatement(e){var i=this.sb;i.push("do "),this.visitNode(e.statement),e.statement.kind==n.NodeKind.BLOCK?i.push(" while ("):(i.push(";\n"),s.indent(i,this.indentLevel),i.push("while (")),this.visitNode(e.condition),i.push(")")}visitEmptyStatement(e){}visitEnumDeclaration(e,i=!1){var t=this.sb;i?t.push("export default "):this.serializeExternalModifiers(e),e.is(n.CommonFlags.CONST)&&t.push("const "),t.push("enum "),this.visitIdentifierExpression(e.name);var r=e.values.length;if(r){t.push(" {\n");let i=++this.indentLevel;s.indent(t,i),this.visitEnumValueDeclaration(e.values[0]);for(let n=1;n<r;++n)t.push(",\n"),s.indent(t,i),this.visitEnumValueDeclaration(e.values[n]);t.push("\n"),s.indent(t,--this.indentLevel),t.push("}")}else t.push(" {}")}visitEnumValueDeclaration(e){this.visitIdentifierExpression(e.name),e.value&&(this.sb.push(" = "),this.visitNode(e.value))}visitExportImportStatement(e){var i=this.sb;i.push("export import "),this.visitIdentifierExpression(e.externalName),i.push(" = "),this.visitIdentifierExpression(e.name)}visitExportMember(e){this.visitIdentifierExpression(e.localName),e.exportedName.text!=e.localName.text&&(this.sb.push(" as "),this.visitIdentifierExpression(e.exportedName))}visitExportStatement(e){var i=this.sb;e.isDeclare&&i.push("declare ");var t=e.members;if(t&&t.length){let e=t.length;i.push("export {\n");let n=++this.indentLevel;s.indent(i,n),this.visitExportMember(t[0]);for(let r=1;r<e;++r)i.push(",\n"),s.indent(i,n),this.visitExportMember(t[r]);--this.indentLevel,i.push("\n}")}else i.push("export {}");var n=e.path;n&&(i.push(" from "),this.visitStringLiteralExpression(n)),i.push(";")}visitExportDefaultStatement(e){var i=e.declaration;switch(i.kind){case n.NodeKind.ENUMDECLARATION:this.visitEnumDeclaration(i,!0);break;case n.NodeKind.FUNCTIONDECLARATION:this.visitFunctionDeclaration(i,!0);break;case n.NodeKind.CLASSDECLARATION:this.visitClassDeclaration(i,!0);break;case n.NodeKind.INTERFACEDECLARATION:this.visitInterfaceDeclaration(i,!0);break;case n.NodeKind.NAMESPACEDECLARATION:this.visitNamespaceDeclaration(i,!0);break;default:assert(!1)}}visitExpressionStatement(e){this.visitNode(e.expression)}visitFieldDeclaration(e){var i=e.decorators;if(i)for(let e=0,t=i.length;e<t;++e)this.serializeDecorator(i[e]);this.serializeAccessModifiers(e),this.visitIdentifierExpression(e.name);var t=this.sb;e.flags&n.CommonFlags.DEFINITE_ASSIGNMENT&&t.push("!");var s=e.type;s&&(t.push(": "),this.visitTypeNode(s));var r=e.initializer;r&&(t.push(" = "),this.visitNode(r))}visitForStatement(e){var i=this.sb;i.push("for (");var t=e.initializer;t&&this.visitNode(t);var s=e.condition;s?(i.push("; "),this.visitNode(s)):i.push(";");var n=e.incrementor;n?(i.push("; "),this.visitNode(n)):i.push(";"),i.push(") "),this.visitNode(e.statement)}visitFunctionDeclaration(e,i=!1){var t=this.sb,s=e.decorators;if(s)for(let e=0,i=s.length;e<i;++e)this.serializeDecorator(s[e]);i?t.push("export default "):(this.serializeExternalModifiers(e),this.serializeAccessModifiers(e)),e.name.text.length?t.push("function "):t.push("function"),this.visitFunctionCommon(e)}visitFunctionCommon(e){var i=this.sb;this.visitIdentifierExpression(e.name);var t=e.signature,r=e.typeParameters;if(r){let e=r.length;if(e){i.push("<"),this.visitTypeParameter(r[0]);for(let t=1;t<e;++t)i.push(", "),this.visitTypeParameter(r[t]);i.push(">")}}if(2==e.arrowKind){let e=t.parameters;assert(1==e.length),assert(!t.explicitThisType),this.serializeParameter(e[0])}else{i.push("(");let e=t.parameters,s=e.length,n=t.explicitThisType;if(n&&(i.push("this: "),this.visitTypeNode(n)),s){n&&i.push(", "),this.serializeParameter(e[0]);for(let t=1;t<s;++t)i.push(", "),this.serializeParameter(e[t])}}var a=e.body,o=t.returnType;e.arrowKind?a?(2==e.arrowKind?assert(s.isTypeOmitted(o)):s.isTypeOmitted(o)?i.push(")"):(i.push("): "),this.visitTypeNode(o)),i.push(" => "),this.visitNode(a)):(assert(!s.isTypeOmitted(o)),i.push(" => "),this.visitTypeNode(o)):(s.isTypeOmitted(o)||e.isAny(n.CommonFlags.CONSTRUCTOR|n.CommonFlags.SET)?i.push(")"):(i.push("): "),this.visitTypeNode(o)),a&&(i.push(" "),this.visitNode(a)))}visitIfStatement(e){var i=this.sb;i.push("if ("),this.visitNode(e.condition),i.push(") ");var t=e.ifTrue;this.visitNode(t),t.kind!=n.NodeKind.BLOCK&&i.push(";\n");var s=e.ifFalse;s&&(t.kind==n.NodeKind.BLOCK?i.push(" else "):i.push("else "),this.visitNode(s))}visitImportDeclaration(e){var i=e.foreignName,t=e.name;this.visitIdentifierExpression(i),i.text!=t.text&&(this.sb.push(" as "),this.visitIdentifierExpression(t))}visitImportStatement(e){var i=this.sb;i.push("import ");var t=e.declarations,n=e.namespaceName;if(t){let e=t.length;if(e){i.push("{\n");let n=++this.indentLevel;s.indent(i,n),this.visitImportDeclaration(t[0]);for(let r=1;r<e;++r)i.push(",\n"),s.indent(i,n),this.visitImportDeclaration(t[r]);--this.indentLevel,i.push("\n} from ")}else i.push("{} from ")}else n&&(i.push("* as "),this.visitIdentifierExpression(n),i.push(" from "));this.visitStringLiteralExpression(e.path)}visitIndexSignatureDeclaration(e){var i=this.sb;i.push("[key: "),this.visitTypeNode(e.keyType),i.push("]: "),this.visitTypeNode(e.valueType)}visitInterfaceDeclaration(e,i=!1){var t=e.decorators;if(t)for(let e=0,i=t.length;e<i;++e)this.serializeDecorator(t[e]);var n=this.sb;i?n.push("export default "):this.serializeExternalModifiers(e),n.push("interface "),this.visitIdentifierExpression(e.name);var r=e.typeParameters;if(r&&r.length){n.push("<"),this.visitTypeParameter(r[0]);for(let e=1,i=r.length;e<i;++e)n.push(", "),this.visitTypeParameter(r[e]);n.push(">")}var a=e.extendsType;a&&(n.push(" extends "),this.visitTypeNode(a)),n.push(" {\n");var o=++this.indentLevel,E=e.members;for(let e=0,i=E.length;e<i;++e)s.indent(n,o),this.visitNodeAndTerminate(E[e]);--this.indentLevel,n.push("}")}visitMethodDeclaration(e){var i=e.decorators;if(i)for(let e=0,t=i.length;e<t;++e)this.serializeDecorator(i[e]);this.serializeAccessModifiers(e),e.is(n.CommonFlags.GET)?this.sb.push("get "):e.is(n.CommonFlags.SET)&&this.sb.push("set "),this.visitFunctionCommon(e)}visitNamespaceDeclaration(e,i=!1){var t=e.decorators;if(t)for(let e=0,i=t.length;e<i;++e)this.serializeDecorator(t[e]);var n=this.sb;i?n.push("export default "):this.serializeExternalModifiers(e),n.push("namespace "),this.visitIdentifierExpression(e.name);var r=e.members;if(r.length){n.push(" {\n");let e=++this.indentLevel;for(let i=0,t=r.length;i<t;++i)s.indent(n,e),this.visitNodeAndTerminate(r[i]);s.indent(n,--this.indentLevel),n.push("}")}else n.push(" {}")}visitReturnStatement(e){var i=e.value;i?(this.sb.push("return "),this.visitNode(i)):this.sb.push("return")}visitSwitchCase(e){var i=this.sb,t=e.label;t?(i.push("case "),this.visitNode(t),i.push(":\n")):i.push("default:\n");var n=e.statements,r=n.length;if(r){let e=++this.indentLevel;s.indent(i,e),this.visitNodeAndTerminate(n[0]);for(let t=1;t<r;++t)s.indent(i,e),this.visitNodeAndTerminate(n[t]);--this.indentLevel}}visitSwitchStatement(e){var i=this.sb;i.push("switch ("),this.visitNode(e.condition),i.push(") {\n");var t=++this.indentLevel,n=e.cases;for(let e=0,r=n.length;e<r;++e)s.indent(i,t),this.visitSwitchCase(n[e]),i.push("\n");--this.indentLevel,i.push("}")}visitThrowStatement(e){this.sb.push("throw "),this.visitNode(e.value)}visitTryStatement(e){var i=this.sb;i.push("try {\n");var t=++this.indentLevel,n=e.statements;for(let e=0,r=n.length;e<r;++e)s.indent(i,t),this.visitNodeAndTerminate(n[e]);var r=e.catchVariable;if(r){s.indent(i,t-1),i.push("} catch ("),this.visitIdentifierExpression(r),i.push(") {\n");let n=e.catchStatements;if(n)for(let e=0,r=n.length;e<r;++e)s.indent(i,t),this.visitNodeAndTerminate(n[e])}var a=e.finallyStatements;if(a){s.indent(i,t-1),i.push("} finally {\n");for(let e=0,n=a.length;e<n;++e)s.indent(i,t),this.visitNodeAndTerminate(a[e])}s.indent(i,t-1),i.push("}")}visitTypeDeclaration(e){var i=e.decorators;if(i)for(let e=0,t=i.length;e<t;++e)this.serializeDecorator(i[e]);var t=this.sb;this.serializeExternalModifiers(e),t.push("type "),this.visitIdentifierExpression(e.name);var s=e.typeParameters;if(s){let e=s.length;if(e){t.push("<");for(let i=0;i<e;++i)this.visitTypeParameter(s[i]);t.push(">")}}t.push(" = "),this.visitTypeNode(e.type)}visitVariableDeclaration(e){this.visitIdentifierExpression(e.name);var i=e.type,t=this.sb;e.flags&n.CommonFlags.DEFINITE_ASSIGNMENT&&t.push("!"),i&&(t.push(": "),this.visitTypeNode(i));var s=e.initializer;s&&(t.push(" = "),this.visitNode(s))}visitVariableStatement(e){var i=e.decorators;if(i)for(let e=0,t=i.length;e<t;++e)this.serializeDecorator(i[e]);var t=this.sb,s=e.declarations,r=assert(s.length),a=s[0];this.serializeExternalModifiers(a),t.push(a.is(n.CommonFlags.CONST)?"const ":a.is(n.CommonFlags.LET)?"let ":"var "),this.visitVariableDeclaration(e.declarations[0]);for(let i=1;i<r;++i)t.push(", "),this.visitVariableDeclaration(e.declarations[i])}visitWhileStatement(e){var i=this.sb;i.push("while ("),this.visitNode(e.condition),e.statement.kind==n.NodeKind.EMPTY?i.push(")"):(i.push(") "),this.visitNode(e.statement))}serializeDecorator(e){var i=this.sb;i.push("@"),this.visitNode(e.name);var t=e.arguments;if(t){i.push("(");let e=t.length;if(e){this.visitNode(t[0]);for(let s=1;s<e;++s)i.push(", "),this.visitNode(t[s])}i.push(")\n")}else i.push("\n");s.indent(i,this.indentLevel)}serializeParameter(e){var i=this.sb,t=e.parameterKind,r=e.implicitFieldDeclaration;r&&this.serializeAccessModifiers(r),t==n.ParameterKind.REST&&i.push("..."),this.visitIdentifierExpression(e.name);var a=e.type,o=e.initializer;a&&(t!=n.ParameterKind.OPTIONAL||o||i.push("?"),s.isTypeOmitted(a)||(i.push(": "),this.visitTypeNode(a))),o&&(i.push(" = "),this.visitNode(o))}serializeExternalModifiers(e){var i=this.sb;e.is(n.CommonFlags.EXPORT)?i.push("export "):e.is(n.CommonFlags.IMPORT)?i.push("import "):e.is(n.CommonFlags.DECLARE)&&i.push("declare ")}serializeAccessModifiers(e){var i=this.sb;e.is(n.CommonFlags.PUBLIC)?i.push("public "):e.is(n.CommonFlags.PRIVATE)?i.push("private "):e.is(n.CommonFlags.PROTECTED)&&i.push("protected "),e.is(n.CommonFlags.STATIC)?i.push("static "):e.is(n.CommonFlags.ABSTRACT)&&i.push("abstract "),e.is(n.CommonFlags.READONLY)&&i.push("readonly ")}finish(){var e=this.sb.join("");return this.sb=[],e}}i.ASTBuilder=r},function(e,i,t){"use strict";Object.defineProperty(i,"__esModule",{value:!0});const s=t(0);i.indent=function(e,i){for(;i>=4;)e.push("        "),i-=4;i>=2&&(e.push("    "),i-=2),i&&e.push("  ")},i.isTypeOmitted=function(e){if(e.kind==s.NodeKind.NAMEDTYPE){let i=e.name;return!(i.next||i.identifier.text.length)}return!1},i.operatorTokenToString=function(e){switch(e){case s.Token.DELETE:return"delete";case s.Token.IN:return"in";case s.Token.INSTANCEOF:return"instanceof";case s.Token.NEW:return"new";case s.Token.TYPEOF:return"typeof";case s.Token.VOID:return"void";case s.Token.YIELD:return"yield";case s.Token.DOT_DOT_DOT:return"...";case s.Token.COMMA:return",";case s.Token.LESSTHAN:return"<";case s.Token.GREATERTHAN:return">";case s.Token.LESSTHAN_EQUALS:return"<=";case s.Token.GREATERTHAN_EQUALS:return">=";case s.Token.EQUALS_EQUALS:return"==";case s.Token.EXCLAMATION_EQUALS:return"!=";case s.Token.EQUALS_EQUALS_EQUALS:return"===";case s.Token.EXCLAMATION_EQUALS_EQUALS:return"!==";case s.Token.PLUS:return"+";case s.Token.MINUS:return"-";case s.Token.ASTERISK_ASTERISK:return"**";case s.Token.ASTERISK:return"*";case s.Token.SLASH:return"/";case s.Token.PERCENT:return"%";case s.Token.PLUS_PLUS:return"++";case s.Token.MINUS_MINUS:return"--";case s.Token.LESSTHAN_LESSTHAN:return"<<";case s.Token.GREATERTHAN_GREATERTHAN:return">>";case s.Token.GREATERTHAN_GREATERTHAN_GREATERTHAN:return">>>";case s.Token.AMPERSAND:return"&";case s.Token.BAR:return"|";case s.Token.CARET:return"^";case s.Token.EXCLAMATION:return"!";case s.Token.TILDE:return"~";case s.Token.AMPERSAND_AMPERSAND:return"&&";case s.Token.BAR_BAR:return"||";case s.Token.EQUALS:return"=";case s.Token.PLUS_EQUALS:return"+=";case s.Token.MINUS_EQUALS:return"-=";case s.Token.ASTERISK_EQUALS:return"*=";case s.Token.ASTERISK_ASTERISK_EQUALS:return"**=";case s.Token.SLASH_EQUALS:return"/=";case s.Token.PERCENT_EQUALS:return"%=";case s.Token.LESSTHAN_LESSTHAN_EQUALS:return"<<=";case s.Token.GREATERTHAN_GREATERTHAN_EQUALS:return">>=";case s.Token.GREATERTHAN_GREATERTHAN_GREATERTHAN_EQUALS:return">>>=";case s.Token.AMPERSAND_EQUALS:return"&=";case s.Token.BAR_EQUALS:return"|=";case s.Token.CARET_EQUALS:return"^=";default:return assert(!1),""}},i.i64_to_string=function(e,i=!1){var t=new Array;!i&&e<0&&(t.push(45),e=-e);do{t.push(48+e%10),e/=10}while(e);return String.fromCharCodes(t)}},function(e,i,t){"use strict";Object.defineProperty(i,"__esModule",{value:!0});i.AbstractVisitor=class{visit(e){var i;if(null!=e)if(e instanceof Array)e.map(e=>{this.visit(e)});else if(e instanceof Map)for(let[i,t]of e.entries())this.visit(t);else if(null!=(i=e)&&"function"==typeof i[Symbol.iterator])for(let i of e)this.visit(i);else this._visit(e)}}},function(e,i,t){"use strict";Object.defineProperty(i,"__esModule",{value:!0});const s=t(1),n=["builtin",".spec","dataview","date","math","number","string","typedarray","bindings/Date","bindings/Math"];class r extends s.BaseVisitor{check(e){e.text.substring(0,e.text.indexOf("\n")).includes("ignore")||n.some(i=>e.normalizedPath.includes(i))||this.visit(e)}static check(e){const i=new r;for(let t=0;t<e.program.sources.length;t++)i.check(e.program.sources[t])}visitTypeName(e){/f32|f64/.test(e.identifier.text)&&r.floatsFound.push(e.range.source.normalizedPath+" line: "+e.range.line+" "+e.range.source.text.split("\n")[e.range.line-1])}static checkBinary(e){const i=e.toText();if(/f32|f64/.test(i))throw new Error("Floating point numbers are not allowed in smart contracts: Check\n"+r.floatsFound.join("\n"))}}i.TypeChecker=r,r.floatsFound=[]}])}));